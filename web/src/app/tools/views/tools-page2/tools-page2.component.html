<div class="h-full w-full">
  <!-- 入力フォーム -->
  <div>
    <div class="mb-4 flex items-end justify-between gap-2">
      <div class="flex-1">
        <label class="block text-sm font-medium text-gray-700 mb-2">キーワード</label>
        <input type="url" placeholder="danbooru絵師名を入力" class="w-full border rounded p-1 bg-white resize-none" [(ngModel)]="strInput" />
      </div>
      <div class="w-24">
        <label class="block text-sm font-medium text-gray-700 mb-2">取得ページ数</label>
        <input type="text" class="w-full border rounded p-1 bg-white resize-none" [(ngModel)]="pageInput" appNumberOnly />
      </div>
      <div class="w-16">
        <button class="w-full px-3 py-1 rounded border text-white"
          [disabled]="!strInput || isLoading"
          [ngClass]="!strInput || isLoading ? 'bg-gray-400': 'transition-colors border-blue-500 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 duration-150'"
          (click)="search()">
          確認
        </button>
      </div>
    </div>
  </div>
  <app-content-spinner [showSpinner]="isLoading" [showContentAlways]="true">
    <div class="space-y-4">
      <!-- エラー表示 -->
      @if (result && result.error) {
        <app-notification #notice></app-notification>
      }
      <!-- HTMLレンダリング -->
      @if (result && !result.error) {
        @if (result.data && result.data.html) {
          <div class="border rounded-lg">
            <div class="p-2 bg-gray-50 border-b">
              <h4 class="font-medium text-gray-900">htmlレンダリング</h4>
            </div>
            @for (source of result.data.html; track $index) {
              <div class="bg-white overflow-hidden h-[600px] relative">
                <div class="h-full w-full" style="overflow: auto;">
                  <iframe [srcdoc]="source" style="width: 100%; height: 100%; border: none;" sandbox="allow-same-origin"></iframe>
                </div>
              </div>
            }
          </div>
        }
        <!-- HTML表示 -->
        @if (result.data && result.data.html) {
          <div class="border rounded-lg">
            <div class="p-2 bg-gray-50 border-b">
              <h4 class="font-medium text-gray-900">htmlコード</h4>
            </div>
            @for (source of result.data.html; track $index) {
              <div class="p-2 bg-white text-sm overflow-auto max-h-[600px]">
                <pre class="!bg-transparent !m-0 !p-0"><code class="language-markup">{{source | prettyHtml | async}}</code></pre>
              </div>
            }
          </div>
        }
        <!-- JSON結果 -->
        @if (result.data && result.data.json) {
          <div class="border rounded-lg">
            <div class="p-2 bg-gray-50 border-b">
              <h4 class="font-medium text-gray-900">加工後json</h4>
            </div>
            <div class="p-2 bg-white text-sm overflow-auto max-h-[600px]">
              <pre class="!bg-transparent !m-0 !p-0"><code class="language-json">{{result.data.json | json}}</code></pre>
            </div>
          </div>
        }
      }
    </div>
  </app-content-spinner>
</div>