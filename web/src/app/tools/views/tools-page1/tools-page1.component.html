<div class="h-full w-full">
  <!-- URL入力フォーム -->
  <div>
    <div class="mb-4 flex items-center justify-between gap-2">
      <input type="url" placeholder="danbooru.domain.us / gelbooru.com のポストURLを入力" class="w-full border rounded p-1 bg-white resize-none" [(ngModel)]="urlInput" />
      <button
        class="w-16 px-3 py-1 rounded border text-white"
        [disabled]="!urlInput || isLoading"
        [ngClass]="!urlInput || isLoading ? 'bg-gray-400': 'transition-colors border-blue-500 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 duration-150'"
        (click)="search()">
        確認
      </button>
    </div>
  </div>
  <app-content-spinner [showSpinner]="isLoading" [showContentAlways]="true">
    <div class="space-y-4">
      <!-- エラー表示 -->
      @if (result && result.error) {
        <div class="p-3 bg-red-100 text-red-700 rounded border border-red-300">{{result.code}} : {{result.error}}</div>
      }
      <!-- HTMLレンダリング -->
      @if (result && !result.error) {
        @if (result.data && result.data.html) {
          <div class="border rounded-lg">
            <div class="p-2 bg-gray-50 border-b">
              <h4 class="font-medium text-gray-900">htmlレンダリング</h4>
            </div>
            <div class="bg-white overflow-hidden h-[600px] relative">
              <div class="h-full w-full" style="overflow: auto;">
                <iframe [srcdoc]="result.data.html" style="width: 100%; height: 100%; border: none;" sandbox="allow-same-origin"></iframe>
              </div>
            </div>
          </div>
        }
        <!-- HTML表示 -->
        @if (result.data && result.data.html) {
          <div class="border rounded-lg">
            <div class="p-2 bg-gray-50 border-b">
              <h4 class="font-medium text-gray-900">htmlコード</h4>
            </div>
            <div class="p-2 bg-white text-sm overflow-auto max-h-[600px]">
              <pre class="!bg-transparent !m-0 !p-0"><code class="language-markup">{{result.data.html | prettyHtml | async}}</code></pre>
            </div>
          </div>
        }
        <!-- JSON結果 -->
        @if (result.data && result.data.json) {
          <div class="border rounded-lg">
            <div class="p-2 bg-gray-50 border-b">
              <h4 class="font-medium text-gray-900">加工後json</h4>
            </div>
            <div class="p-2 bg-white text-sm overflow-auto max-h-[600px]">
              <pre class="!bg-transparent !m-0 !p-0"><code class="language-json">{{result.data.json | json}}</code></pre>
            </div>
          </div>
        }
      }
    </div>
  </app-content-spinner>
</div>